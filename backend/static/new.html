<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>ScriptObservatory</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://scriptobservatory.org/style.css">
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.js"></script>
    <!--<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>-->
    <script src="app.js"></script>
    <script src="https://scriptobservatory.org/ui-bootstrap-tpls-0.12.1.min.js"></script>
</head>

<body ng-app="app" ng-controller="AppCtrl as app">

<div role="main">
  <header class="bs-header text-center" id="overview">
      <h1><a href="#" onclick="show_about(); return false;">ScriptObservatory</a></h1> 
      <p>a project to collect, record, and organize information about the <b><i>live content</i></b> people see on the Internet.</p>
  </header>

<div class="bodycontainer">
<div class="querybox" align="center">
  <form class="form-inline" ng-submit="submitQueryForm()">
    <label>Submit a query:</label>
    <div class="form-group">
      <input type="text" class="form-control" name="url" ng-model="parentQueryText" placeholder="URL or SHA-256">
    </div>
    <!---
    <div class="form-group">
      <select ng-model="dateRangeChoice">
        <option selected value="all">All time</option>
        <option value="day">Last 24h</option>
        <option value="week">Last 1w</option>
        <option value="month">Last 1mo</option>
        <option value="year">Last 1y</option>
      </select>
    </div>
    -->
    <div class="form-group">    
      <input type="submit" id="submit" value="Submit" class="btn"></input>
    </div>
  </form>
</div>



    <script class="modal" type="text/ng-template" id="websiteModalContent.html">
        <div class="modal-header">
            <h3 class="modal-title">Website: <a href="{{ currentSite.url }}" target="_blank">{{ currentSite.url }}</a></h3>
        </div>

        <div class="modal-body">
            <h4>Basic Information:</h4>
            <ul>
              <li> Title: xxx </li>
              <li> Title: xxx </li>
            </ul>
            <br>
            <h4>Associated Scripts:</h4>
            <table class="table-condensed table-hover" style="background-color:inherit;">
            <tr ng-repeat="script in currentSite.scripts | object2Array | orderBy:'-occur'"> 
                <td style="width:65%;"> <a href="#" ng-click="ok(); openScript(script);"> {{ script.url | limitTo:80 }}{{ script.url.length > 80 ? '...':'' }} </a> </td>
                <td style="width:10%;"> {{ script.occur.toFixed(1) }}% </td>
                <td style="width:25%;">
                    <span ng-repeat="hash in script.hashes | object2Array | orderBy:'-occur'"> 
                        <a href="#" ng-click="ok(); openHash(hash.hash);"> {{ hash.hash | limitTo:10 }} ({{ hash.occur.toFixed(1) }}%){{ $last ? '' : ', '}} </a>
                    </span>
                </td>
            </tr>
          </table>
          <br>
          <h4>Actions:</h4>
          <ul>
            <!---<li> Scan this website now-->
            <li> View on URLQuery </li>
            <li> View on <a target="_blank" href="https://www.virustotal.com/latest-scan/{{ currentSite.url }}">Virus Total</a> </li>
            <li> View on BuiltWith.com </li>
            <li> Copy URL to Clipboard </li>
          </ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
        </div>
    </script>




  <script class="modal" type="text/ng-template" id="scriptModalContent.html">
        <div class="modal-header">
            <h3 class="modal-title">Script: <a href="{{ currentSite.url }}" target="_blank">{{ currentSite.url }}</a></h3>
        </div>

        <div class="modal-body">
            <h4>Basic Information:</h4>
            <ul>
              <li> Parent URL: xxx </li>
              <li> Script URL: xxx </li>
              <li> Size: xxx </li>
            </ul>
            <br>
            <h4>Observed Hashes:</h4>
            <table class="table-condensed table-hover" style="background-color:inherit;">
                    <span ng-repeat="hash in currentSite.hashes | object2Array | orderBy:'-occur'"> 
                        <a href="#" ng-click="ok(); submitQuery(hash.hash);"> {{ hash.hash | limitTo:10 }} ({{ hash.occur.toFixed(1) }}%){{ $last ? '' : ', '}} </a>
                    </span>
                </td>
            </tr>
          </table>
          <br>
          <h4>Actions:</h4>
          <ul>
            <!---<li> Scan this website now-->
            <li> View on URLQuery </li>
            <li> View on <a target="_blank" href="https://www.virustotal.com/latest-scan/{{ currentSite.url }}">Virus Total</a> </li>
            <li> View on BuiltWith.com </li>
            <li> Copy URL to Clipboard </li>
          </ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
        </div>
    </script>



  <script class="modal" type="text/ng-template" id="hashModalContent.html">
        <div class="modal-header">
            <h3 class="modal-title">Hash: {{ currentHash }}</h3>
        </div>

        <div class="modal-body">
            <h4>Basic Information:</h4>
            <ul>
              <li> Parent URL: xxx </li>
              <li> Script URL: xxx </li>
            </ul>
            <br>
          <br>
          <h4>Actions:</h4>
          <ul>
            <li> View on <a target="_blank" href="https://www.virustotal.com/latest-scan/{{ currentHash }}">Virus Total</a> </li>
            <li> Copy Hash to Clipboard </li>
          </ul>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" ng-click="ok()">OK</button>
        </div>
    </script>



<div class="container" id="about_section">
  <p> 
        The goal of the ScriptObservatory project is to extend the idea behind the <a href="https://www.eff.org/observatory" target="_blank">SSL Observatory</a> by recording information about the <b><i>live content</b></i> people are seeing on the internet.
        <br><br>
        Initially, the only objects that will be analyzed are JavaScript files. Eventually, it might be extended to include other types of content like flash objects and iframes. 
        <br><br>
        The long-term goal of this website is for it to be a place where anyone can analyze the record of what snippets of code people have been sent while on the internet. The long-term goal for the Chrome extension is to crowdsource the data collection and to (optionally) act as a <b><i>content-aware</i></b> script blocker, letting you have finer control over what runs on your computer.
        <br><br>
        You can find more info on the <a href="https://github.com/andy11/ScriptObservatory/" target="_blank">GitHub page</a>. 
        <br><br>
        Some sample queries:
        <ul>
        <li><a href="#" ng-click='submitQuery("https://www.vt.edu/");'>https://www.vt.edu/</a>
        <li><a href="#" ng-click='submitQuery("reddit.com");'>reddit.com</a>
        <li><a href="#" ng-click='submitQuery("http://www.google-analytics.com/ga.js");'>http://www.google-analytics.com/ga.js</a>
        <li><a href="#" ng-click='submitQuery("54210e4001e71dc204bdd71ff0a24f5c5526d5a9d652053464af3f270593eb89");'>54210e4001e71dc204bdd71ff0a24f5c5526d5a9d652053464af3f270593eb89</a>
        </ul>
    </p>
</div>

<div id="website_section" style="display:none; font-size:11px;" >
  <table class="table table-bordered table-condensed">
        <th style="width:30%; text-align:center;"> 
            Site URL <input ng-model="search.url" placeholder="Filter by URL"> 
        </th>
        <th style="width:5%; text-align:center;"> N </th>
        <th style="width:65%; text-align:center;"> Scripts </th>
        <tr ng-repeat="site in app.sites | filter:search.url | orderBy:'-occur'">
            <td style="text-align: center;">
              <a href="#" ng-click="openWebsite(site)">{{ site.url | limitTo: 67 }}{{ site.url.length > 67 ? '...' : '' }}</a>
            </td>
            <td style="text-align: center;">{{ site.occur }}</td>
            <td>
                <table class="table-condensed table-hover" style="background-color:inherit;">
                <tr ng-repeat="script in site.scripts | object2Array | orderBy:'-occur'"> 
                    <td style="width:85%;"> <a href="#" ng-click="openScript(script);"> {{ script.url | limitTo:80 }}{{ script.url.length > 80 ? '...':'' }} </a> </td>
                    <td style="width:15%;"> {{ script.occur.toFixed(1) }}% </td>
                    <!--
                    <td style="width:25%;">
                        <span ng-repeat="hash in script.hashes | object2Array | orderBy:'-occur'"> 
                            <a href="#" ng-click="submitQuery(hash.hash);"> {{ hash.hash | limitTo:10 }} ({{ hash.occur.toFixed(1) }}%){{ $last ? '' : ', '}} </a>
                        </span>
                    </td>
                    -->
                </tr>
                </table>
            </td>
        <tr>
    </table>
</div>
</div>
</div>
</body>
</html>
